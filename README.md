# PycnopodiaRangewideAssessment
Documentation, data, and code accompanying Hamilton et al., 2021 Pycnopodia Rangewide Assessment paper 

#######################################################################################################
Data

MasterPycno_ToShare
Dec_lat = latitude in decimal degrees. Numeric.
Dec_lon = longitude in decimal degrees. Numeric.
Depth = depth in meters. Numeric. 
Pres_abs = presence or absence of Pycnopodia on that survey. Binary. Presence = 1, absence = 0
Density_m2 = density in meters squared if available for that set of surveys. Numeric. NA = no density data available for that survey. 
Source = shorthand name of the group that shared the data with us and the type of data (e.g. trawl, dive). To get further info on who that dataset, group, and group contact, see Table S1. Character.
Note: When datasets contained more than one survey at a site in the same day (e.g. multiple transects), we divided the total Pycnopodia count in all surveys by the total survey area and averaged the latitude, longitude, and depth as necessary in order to minimize the impacts of pseudoreplication on the dataset. 
Used in MaxentSWD_Final and Density-Inc_Models_Figs_Tables_ToShare.

CrashEventsForRPlot
Crash Dates were determined trends in Pycnopodia occurrence (site-level presence or absence) to estimate ‘crash date’, defined as the date when the occurrence rate of Pycnopodia in a region decreased by 75% from pre-outbreak levels. Used in OutbreakTimelineFigs_ToShare.R

EpidemicPhases
See manuscript methods for information on how the column ‘EpidemicPhases’ was created. “Start-End” specifies whether that date was the start or the end of that epidemic phase for that region. Used in OutbreakTimelineFigs_ToShare.R

Incidence_2012-2019
Columns G-J were calculated by fitting a logistic regression model to the occurrence of Pycnopodia over time for each region. We fit a logistic regression model to the occurrence of Pycnopodia from 1/1/2012 to 12/31/2019 to model the shape of the population decline for each region (Fig. 1a). From these models, we 1) estimated regional Pycnopodia occurrence rates on 1/1/2012 and 12/31/2019, 2) calculated the predicted occurrence value corresponding to a 75% decline in starting versus ending occurrence in each region, and 3) solved the inverse logistic equations for the date at which this occurrence value was predicted. All other columns are identifying information derived from MasterPycno_ToShare. Used in OutbreakTimelineFigs_ToShare.R

MasterPycno_021821_SpatialJoin
Used to make Fig 5 for the remnant population analysis. Grid IDs were created in ArcGIS using a spatial join. Used in RemPop_Final.R

Maxent_SWD
	OccurrenceData, BiasFiles, Maxent_EnvironmentalFiles folders all contain data that is used to run Maxent Analysis in Maxent terminal (available here: https://biodiversityinformatics.amnh.org/open_source/maxent/) 
	Maxent_Output contains the output files generated by the Maxent terminal. Used in Maxent_SWD_Final to make Figures 3cd and 4. 
  
########################################################################################################
Code

Density_Inc_Models_Figs_Tables_Toshare
Makes Fig 2, runs models on density and incidence changes across the phases of the pandemic

ContinuedDeclines_Models_Figs_Tables_Toshare
Makes Fig S3, runs models on density and incidence changes for the years 2017-2020 (generally after the outbreak had subsided in many regions). 

OutbreakTimelineFigs_ToShare
Makes Fig1

Maxent_SWD_Final
Prepares Pre and Post-outbreak Pycnopodia incidence and bias files for Maxent program. Maxent analysis must then be run using these files and the Maxent program. For this analysis, we were not able to use Dismo or other R packages that run Maxent because these packages do not give you the ability the adjust the parameter Tau. Maxent may be downloaded at https://biodiversityinformatics.amnh.org/open_source/maxent/. Using the Maxent output files (included in the directory), this code then creates Figure 4 from the manuscript. Figure 3 were made using density data and Maxent output visualized in ArcGIS. 

RemPop_Final.R
Creates Figure 5, runs remnant population analysis. Uses MasterPycno_021821_SpatialJoin.

